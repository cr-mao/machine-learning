## é€»è¾‘å›žå½’

é€»è¾‘å›žå½’æ˜¯è§£å†³äºŒåˆ†ç±»é—®é¢˜çš„åˆ©å™¨


å›žå½’é—®é¢˜æ€Žä¹ˆè§£å†³åˆ†ç±»é—®é¢˜ï¼Ÿ

å°†æ ·æœ¬çš„ç‰¹å¾å’Œæ ·æœ¬å‘ç”Ÿçš„æ¦‚çŽ‡è”ç³»èµ·æ¥ï¼Œæ¦‚çŽ‡æ˜¯ä¸€ä¸ªæ•°ã€‚

```text
y^ = f(x)

p^ = f(x)

y^ = {
   1,   p^ >=0.5
   0,   p^ <0.5
}
```




### åº”ç”¨åœºæ™¯
- ç–¾ç—…æ˜¯å¦æ˜¯é˜³æ€§
- é“¶è¡Œå¡æˆ¿è´·æ¬¾æ˜¯å¦æ”¾è´·
- é¢„æµ‹å¹¿å‘Šç‚¹å‡»çŽ‡ï¼ˆæ˜¯å¦ç‚¹å‡»ï¼Œæ˜¯å¦æŽ¨èè¿™ä¸ªå¹¿å‘Š)
- æ˜¯å¦æ˜¯åžƒåœ¾é‚®ä»¶
- æŽ¨èç³»ç»Ÿä¸­ç”¨åˆ°å¾ˆå¤šäºŒåˆ†ç±»ä»»åŠ¡


### æžå¤§ä¼¼ç„¶ä¼°è®¡

æ ¸å¿ƒæ€æƒ³ï¼š

è®¾æ¨¡åž‹ä¸­å«æœ‰å¾…ä¼°å‚æ•°wï¼Œå¯ä»¥å–å¾ˆå¤šå€¼ã€‚å·²ç»çŸ¥é“äº†æ ·æœ¬è§‚æµ‹å€¼ï¼Œä»Žwçš„ä¸€åˆ‡å¯èƒ½å€¼ä¸­ï¼ˆé€‰å‡ºä¸€ä¸ªä½¿è¯¥è§‚å¯Ÿå€¼å‡ºçŽ°çš„æ¦‚çŽ‡ä¸ºæœ€å¤§çš„å€¼ï¼Œä½œä¸ºwå‚æ•°çš„ä¼°è®¡å€¼ï¼Œè¿™å°±æ˜¯æžå¤§ä¼¼ç„¶ä¼°è®¡ã€‚ï¼ˆé¡¾åæ€ä¹‰ï¼šå°±æ˜¯çœ‹ä¸ŠåŽ»é‚£ä¸ªæ˜¯æœ€å¤§å¯èƒ½çš„æ„æ€ï¼‰


å‡è®¾æœ‰ä¸€æžšä¸å‡åŒ€çš„ç¡¬å¸ï¼Œå‡ºçŽ°æ­£é¢çš„æ¦‚çŽ‡å’Œåé¢çš„æ¦‚çŽ‡æ˜¯ä¸åŒçš„ã€‚å‡å®šå‡ºçŽ°æ­£é¢çš„æ¦‚çŽ‡ä¸ºðœƒï¼Œ æŠ›äº†6æ¬¡å¾—åˆ°å¦‚ä¸‹çŽ°è±¡ D = {æ­£é¢ï¼Œåé¢ï¼Œåé¢ï¼Œæ­£é¢ï¼Œæ­£é¢ï¼Œæ­£é¢}ã€‚æ¯æ¬¡æŠ•æŽ·äº‹ä»¶éƒ½æ˜¯ç›¸äº’ç‹¬ç«‹çš„ã€‚ åˆ™æ ¹æ®äº§ç”Ÿçš„çŽ°è±¡Dï¼Œæ¥ä¼°è®¡å‚æ•°ðœƒæ˜¯å¤šå°‘?

```text
P(D|ðœƒ) = P {æ­£é¢ï¼Œåé¢ï¼Œåé¢ï¼Œæ­£é¢ï¼Œæ­£é¢ï¼Œæ­£é¢}
 = P(æ­£é¢|ðœƒ) P(æ­£é¢|ðœƒ) P(æ­£é¢|ðœƒ) P(æ­£é¢|ðœƒ) P(æ­£é¢|ðœƒ) P(æ­£é¢|ðœƒ)

=ðœƒ *(1-ðœƒ)*(1-ðœƒ)ðœƒ*ðœƒ*ðœƒ = ðœƒ^4(1 âˆ’ ðœƒ)^2

æ±‚æ­¤å‡½æ•°çš„æžå¤§å€¼æ—¶ï¼Œä¼°è®¡ðœƒä¸ºå¤šå°‘
```
```text
å¯¹ä¸Šé¢å‡½æ•°æ±‚å¯¼
4ðœƒ^3.(1-ðœƒ)^2+ ðœƒ^4. 2(1-ðœƒ)*-1
= 4ðœƒ^3.(1-ðœƒ)^2 - 2ðœƒ^4(1-ðœƒ)

= ðœƒ^3.(1-ðœƒ)( 4-4ðœƒ ) - ðœƒ^3.(1-ðœƒ)(2ðœƒ)
= ðœƒ^3.(1-ðœƒ)(4-6ðœƒ ) = 0 

ðœƒ1=0 ,ðœƒ2=1,ðœƒ3=2/3 
å› ä¸º0ï¼Œ1ä¸å¯èƒ½ï¼Œæ‰€ä»¥ðœƒ å–2/3
```

![](images/ml_31.png)

```text
ln(1/a)=ln(a^-1)=-lna
ln(1/2Ï€^(n/2)) = - ln 2Ï€^(n/2) =-n/2 ln 2Ï€
```

### é€»è¾‘å›žå½’çš„åŽŸç†


 åŸºæœ¬æ€æƒ³

1. åˆ©ç”¨çº¿æ€§æ¨¡åž‹ f(x) = wx + b æ ¹æ®ç‰¹å¾çš„é‡è¦æ€§è®¡ç®—å‡ºä¸€ä¸ªå€¼
2. å†ä½¿ç”¨ sigmoid å‡½æ•°å°† f(x) çš„è¾“å‡ºå€¼æ˜ å°„ä¸ºæ¦‚çŽ‡å€¼
   1. è®¾ç½®é˜ˆå€¼(eg:0.5)ï¼Œè¾“å‡ºæ¦‚çŽ‡å€¼å¤§äºŽ 0.5ï¼Œåˆ™å°†æœªçŸ¥æ ·æœ¬è¾“å‡ºä¸º 1 ç±»
   2. å¦åˆ™è¾“å‡ºä¸º 0 ç±»

3. é€»è¾‘å›žå½’çš„å‡è®¾å‡½æ•°
   -  h(w) = sigmoid(wx + b )
   - çº¿æ€§å›žå½’çš„è¾“å‡ºï¼Œä½œä¸ºé€»è¾‘å›žå½’çš„è¾“å…¥


é€»è¾‘å›žå½’ä¸­ï¼Œå…¶è¾“å…¥å€¼æ˜¯ä»€ä¹ˆ
  - é€»è¾‘å›žå½’çš„è¾“å…¥å°±æ˜¯ä¸€ä¸ªçº¿æ€§æ–¹ç¨‹
  - h(w) = w1x1 + w2x2 + .... + b 

å¦‚ä½•åˆ¤æ–­é€»è¾‘å›žå½’çš„è¾“å‡º
  - sigmoidå‡½æ•°
   ![](images/ml_27.png)

Ïƒ(t) = 1/(1+e^-t)


åˆ¤æ–­æ ‡å‡†

å›žå½’çš„ç»“æžœè¾“å…¥åˆ°sigmoidå‡½æ•°å½“ä¸­
è¾“å‡ºç»“æžœï¼š[0, 1]åŒºé—´ä¸­çš„ä¸€ä¸ªæ¦‚çŽ‡å€¼ï¼Œé»˜è®¤ä¸º0.5ä¸ºé˜ˆå€¼

![](images/ml_28.png)


sigmodå‡½æ•°å¯å¯¼ï¼Œæ˜¯å•è°ƒé€’å¢žå‡½æ•°ã€‚ 

å¯¼å‡½æ•°å…¬å¼ï¼š f'(x) = f(x) (1-f(x))

é€»è¾‘å›žå½’æœ€ç»ˆçš„åˆ†ç±»æ˜¯é€šè¿‡å±žäºŽæŸä¸ªç±»åˆ«çš„æ¦‚çŽ‡å€¼æ¥åˆ¤æ–­æ˜¯å¦å±žäºŽæŸä¸ªç±»åˆ«ï¼Œå¹¶ä¸”è¿™ä¸ªç±»åˆ«é»˜è®¤æ ‡è®°ä¸º1(æ­£ä¾‹),å¦å¤–çš„ä¸€ä¸ªç±»åˆ«ä¼šæ ‡è®°ä¸º0(åä¾‹)ã€‚ï¼ˆæ–¹ä¾¿æŸå¤±è®¡ç®—ï¼‰


![](images/ml_32.png)




#### æŸå¤±å‡½æ•°

å…¶æŸå¤±å‡½æ•°é€šå¸¸æ˜¯å¯¹æ•°æŸå¤±å‡½æ•°ï¼ˆlog lossï¼‰ï¼Œä¹Ÿç§°ä¸ºäº¤å‰ç†µæŸå¤±å‡½æ•°ï¼ˆcross-entropy lossï¼‰ã€‚å¯¹äºŽé€»è¾‘å›žå½’æ¨¡åž‹ï¼ŒæŸå¤±å‡½æ•°çš„å®šä¹‰å¦‚ä¸‹ï¼š

![](images/ml_34.png)

1. ä¸€ä¸ªæ ·æœ¬
- å‡è®¾æœ‰2ä¸ªç±»åˆ«ï¼Œ1çš„ç±»åˆ«æ¦‚çŽ‡æ˜¯pï¼Œ 0çš„ç±»åˆ«æ¦‚çŽ‡æ˜¯1-p
```text
L = {
   p    if y = 1
   1-p  if y = 0
}
æ ·æœ¬æ˜¯1çš„æ¦‚çŽ‡æ˜¯p,æ ·æœ¬æ˜¯0çš„æ¦‚çŽ‡æ˜¯1-p

ä¸Šé¢ç­‰ä»·äºŽè¿™ä¸ªå…¬å¼
L = p^y . (1-p)^(1-y)
```

2. nä¸ªæ ·æœ¬
```text
L = (p1^y1 . (1-p1)^(1-y1)) * (p2^y2 . (1-p2)^(1-y2)) * .... * (p2^yn . (1-p2)^(1-yn)) 
pi ä¸º æ¯ä¸ªæ ·æœ¬ è¢«åˆ†ç±»æ­£ç¡®æ—¶çš„æ¦‚çŽ‡
yi ä¸ºè¡¨ç¤ºæ¯ä¸ªæ ·æœ¬çš„çœŸå®žç±»åˆ«
```

3. å¯¹ä¸Šé¢å…¬å¼æ±‚å¯¹æ•°è½¬æ¢å…¬å¼
![](images/ml_35.png)

**è®©è”åˆæ¦‚çŽ‡æœ€å¤§æ—¶ï¼Œä¼°è®¡w,bçš„å‚æ•°ï¼Œå°±æ˜¯æžå¤§æ‹Ÿç„¶ä¼°è®¡** 

æœ€å¤§åŒ–é—®é¢˜å˜æˆæœ€å°åŒ–

![](images/ml_36.png)

4. ä½¿ç”¨æ¢¯åº¦ä¸‹é™ç®—æ³•ï¼Œæ›´æ–°é€»è¾‘å›žå½’ç®—æ³•çš„æƒé‡å‚æ•°



